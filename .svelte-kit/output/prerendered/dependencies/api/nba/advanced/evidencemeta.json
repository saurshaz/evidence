{"queries":[{"id":"seed_details","compiledQueryString":"SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC","inputQueryString":"SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC","compiled":false,"inline":false},{"id":"seed_details_cdf","compiledQueryString":"WITH \ncte_seeds AS (\n    SELECT DISTINCT seed\n    FROM (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC)\n    UNION ALL\n    SELECT 0 AS seed\n),\ncte_teams AS(\n    SELECT DISTINCT team, conf, S.seed\n    FROM (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC) SD\n    LEFT JOIN cte_seeds S ON 1=1\n),\ncte_interim_calc AS (\nSELECT \n    T.team, \n    T.seed, \n    T.conf, \n    COALESCE(SD.occurances_pct1,0) AS occurances_pct1\nFROM cte_teams T\nLEFT JOIN (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC) SD ON T.team = SD.team AND T.seed = SD.seed\n)\nSELECT *, SUM(occurances_pct1) OVER (PARTITION BY team ORDER BY seed) AS cumulative_pct1\nFROM cte_interim_calc\nORDER BY seed, cumulative_pct1","inputQueryString":"WITH \ncte_seeds AS (\n    SELECT DISTINCT seed\n    FROM ${seed_details}\n    UNION ALL\n    SELECT 0 AS seed\n),\ncte_teams AS(\n    SELECT DISTINCT team, conf, S.seed\n    FROM ${seed_details} SD\n    LEFT JOIN cte_seeds S ON 1=1\n),\ncte_interim_calc AS (\nSELECT \n    T.team, \n    T.seed, \n    T.conf, \n    COALESCE(SD.occurances_pct1,0) AS occurances_pct1\nFROM cte_teams T\nLEFT JOIN ${seed_details} SD ON T.team = SD.team AND T.seed = SD.seed\n)\nSELECT *, SUM(occurances_pct1) OVER (PARTITION BY team ORDER BY seed) AS cumulative_pct1\nFROM cte_interim_calc\nORDER BY seed, cumulative_pct1","compiled":true,"inline":true},{"id":"seed_details_cdf_scatter","compiledQueryString":"SELECT * FROM (WITH \ncte_seeds AS (\n    SELECT DISTINCT seed\n    FROM (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC)\n    UNION ALL\n    SELECT 0 AS seed\n),\ncte_teams AS(\n    SELECT DISTINCT team, conf, S.seed\n    FROM (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC) SD\n    LEFT JOIN cte_seeds S ON 1=1\n),\ncte_interim_calc AS (\nSELECT \n    T.team, \n    T.seed, \n    T.conf, \n    COALESCE(SD.occurances_pct1,0) AS occurances_pct1\nFROM cte_teams T\nLEFT JOIN (SELECT\n    winning_team as team,\n    season_rank as seed,\n    conf,\n    count(*) / 10000.0 as occurances_pct1\nFROM src_reg_season_end\nGROUP BY ALL\nORDER BY seed, count(*) DESC) SD ON T.team = SD.team AND T.seed = SD.seed\n)\nSELECT *, SUM(occurances_pct1) OVER (PARTITION BY team ORDER BY seed) AS cumulative_pct1\nFROM cte_interim_calc\nORDER BY seed, cumulative_pct1)\nWHERE cumulative_pct1 > 0.005 AND cumulative_pct1 < 0.995","inputQueryString":"SELECT * FROM ${seed_details_cdf}\nWHERE cumulative_pct1 > 0.005 AND cumulative_pct1 < 0.995","compiled":true,"inline":true}]}